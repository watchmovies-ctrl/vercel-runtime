{% extends "base.html" %}{% block title %}Performance Analytics{% endblock %}{% block content %}<div class="glass-card" style="height: 400px; margin-bottom: 24px;"><span class="kpi-label">7-Day Plant Efficiency Trend</span><div style="height: 320px; margin-top: 15px;"><canvas id="trendChart"></canvas></div></div><div class="grid-2"><div class="glass-card"><h3>Machine Rankings (All Time)</h3><table><thead><tr><th>Rank</th><th>Machine</th><th>Avg Efficiency</th><th>Performance Bar</th></tr></thead><tbody>{% for m in rankings %}<tr><td><strong>#{{ loop.index }}</strong></td><td>{{ m.name }}</td><td>{{ m.avg_eff }}%</td><td style="width:40%;"><div class="progress-bar"><div class="progress-fill" style="width: {{ m.avg_eff }}%; background: {% if m.avg_eff >= 90 %}#10b981{% elif m.avg_eff >= 75 %}#fbbf24{% else %}#ef4444{% endif %};"></div></div></td></tr>{% endfor %}</tbody></table></div><div class="glass-card"><h3>Downtime Distribution</h3><div style="height: 250px;"><canvas id="downtimeChart"></canvas></div></div></div><script>document.addEventListener('DOMContentLoaded', () => { new Chart(document.getElementById('trendChart'), { type: 'line', data: { labels: {{ trend_labels | tojson }}, datasets: [{ label: 'Avg Efficiency (%)', data: {{ trend_data | tojson }}, borderColor: '#6366f1', backgroundColor: 'rgba(99, 102, 241, 0.1)', fill: true, tension: 0.4 }] }, options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, max: 100 } } } }); new Chart(document.getElementById('downtimeChart'), { type: 'pie', data: { labels: ['Maintenance', 'Material Shortage', 'Operator Unavailable', 'Setup Time'], datasets: [{ data: [30, 25, 15, 30], backgroundColor: ['#ef4444', '#f59e0b', '#6366f1', '#10b981'], borderWidth: 0 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right' } } } }); });</script>{% endblock %}